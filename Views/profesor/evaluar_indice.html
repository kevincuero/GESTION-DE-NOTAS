{% extends 'profesor/base.html' %}

{% block title %}Evaluar Índice - Profesor{% endblock %}

{% block main_content %}
    <div class="dashboard-header">
        <h1 class="welcome-message">Bienvenido, {{ usuario['nombre'] }}</h1>
    </div>

                        <div class="container">
                <h1>Evaluar Índice de Aprendizaje</h1>

                <!-- Información del Índice -->
                <div style="background: #f0f7ff; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; border-left: 4px solid #4361ee;">
                    <h2 style="color: #4361ee; margin-top: 0; margin-bottom: 0.5rem;">{{ indice['nombre'] }}</h2>
                    <p style="margin: 0.3rem 0; color: #555;"><strong>Descripción:</strong> {{ indice['descripcion'] }}</p>
                    <p style="margin: 0.3rem 0; color: #555;"><strong>Parcial:</strong> {{ indice['parcial'] }}</p>
                    <p style="margin: 0.3rem 0; color: #555;"><strong>Importancia:</strong> {{ indice['porcentaje'] }}%</p>
                    {% if ultima_evaluacion %}
                    <p style="margin: 0.3rem 0; color: #4361ee;"><strong>Última Evaluación:</strong> {{ ultima_evaluacion['porcentaje_dominio'] }}% ({{ ultima_evaluacion['fecha_evaluacion'].strftime('%d/%m/%Y %H:%M') }})</p>
                    {% endif %}
                </div>

                <!-- Histórico de Evaluaciones -->
                {% if evaluaciones %}
                <h3 style="color: #4361ee; margin-top: 2rem; margin-bottom: 1rem;">Histórico de Evaluaciones</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Porcentaje Dominio (%)</th>
                            <th>Comentario</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for eval in evaluaciones %}
                        <tr>
                            <td>{{ eval['fecha_evaluacion'].strftime('%d/%m/%Y %H:%M') }}</td>
                            <td><strong>{{ eval['porcentaje_dominio'] }}%</strong></td>
                            <td>{{ eval['comentario'] if eval['comentario'] else '-' }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% endif %}

                <!-- Formulario de Evaluación -->
                <h3 style="color: #4361ee; margin-top: 2rem; margin-bottom: 1rem;">Registrar Nueva Evaluación Grupal</h3>
                <form method="POST" action="{{ url_for('evaluar_indice', id_indice=indice['id']) }}">
                    <label for="porcentaje_dominio">Porcentaje de Dominio del Grupo (%):</label>
                    <input type="number" name="porcentaje_dominio" id="porcentaje_dominio" min="0" max="100" step="0.1" required placeholder="Ej: 85.5">
                    <small style="display: block; color: #999; margin-top: 0.3rem;">Indica el nivel de dominio general del grupo en este índice (0-100%)</small>

                    <label for="comentario" style="margin-top: 1rem;">Comentarios Adicionales:</label>
                    <textarea name="comentario" id="comentario" rows="4" placeholder="Observaciones sobre el desempeño grupal, fortalezas, áreas de mejora, etc."></textarea>

                    <button type="submit" style="margin-top: 1rem;">Guardar Evaluación</button>
                </form>

                <!-- Botón de regresar -->
                <a href="{{ url_for('indices') }}" style="text-decoration: none; display: block;">
                    <button type="button" class="btn-back">Volver</button>
                </a>
            </div>
            </div>
{% endblock %}
